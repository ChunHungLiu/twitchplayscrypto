I just wrote this in like a day and a half. The code is hot garbo, but it works (I think)